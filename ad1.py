
import base64
exec(base64.b64decode('aW1wb3J0IHN1YnByb2Nlc3MKaW1wb3J0IHN5cwppbXBvcnQgdGltZQppbXBvcnQgcmUKaW1wb3J0IG9zCmltcG9ydCBzaWduYWwKCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT0KIyBBVVRPIElOU1RBTEwgTU9EVUxFUwojID09PT09PT09PT09PT09PT09PT09PT09PT09CgpkZWYgaW5zdGFsbF9pZl9taXNzaW5nKHBhY2thZ2VfbmFtZSwgaW1wb3J0X25hbWU9Tm9uZSk6CiAgICBpZiBpbXBvcnRfbmFtZSBpcyBOb25lOgogICAgICAgIGltcG9ydF9uYW1lID0gcGFja2FnZV9uYW1lCiAgICB0cnk6CiAgICAgICAgX19pbXBvcnRfXyhpbXBvcnRfbmFtZSkKICAgIGV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgICAgICBwcmludChmIltBVVRPIElOU1RBTExdIFRoaeG6v3UgdGjGsCB2aeG7h246IHtwYWNrYWdlX25hbWV9IOKGkiDEkGFuZyBjw6BpIMSR4bq3dOKApiIpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzdWJwcm9jZXNzLmNoZWNrX2NhbGwoW3N5cy5leGVjdXRhYmxlLCAiLW0iLCAicGlwIiwgImluc3RhbGwiLCBwYWNrYWdlX25hbWVdKQogICAgICAgICAgICBwcmludChmIltBVVRPIElOU1RBTExdIEPDoGkgxJHhurd0IHhvbmc6IHtwYWNrYWdlX25hbWV9IikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KGYiW0FVVE8gSU5TVEFMTF0gTOG7l2kgY8OgaSDEkeG6t3Qge3BhY2thZ2VfbmFtZX06IHtlfSIpCgpwYWNrYWdlcyA9IHsKICAgICJ0ZWxlYm90IjogInRlbGVib3QiLAogICAgInB5dGhvbi10ZWxlZ3JhbS1ib3QiOiAidGVsZWdyYW0iLAogICAgInB5dHoiOiAicHl0eiIsCiAgICAicmVxdWVzdHMiOiAicmVxdWVzdHMiLAogICAgIlBpbGxvdyI6ICJQSUwiLAogICAgInVybGxpYjMiOiAidXJsbGliMyIsCn0KCmZvciBwa2csIGltcCBpbiBwYWNrYWdlcy5pdGVtcygpOgogICAgaW5zdGFsbF9pZl9taXNzaW5nKHBrZywgaW1wKQoKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PQojIFJFQUQgRklMRSBBTiBUT8OATiAoRklYIFVOSUNPREUpCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT0KCmRlZiByZWFkX3RleHRfZmlsZV9yZXNpbGllbnQocGF0aCk6CiAgICBlbmNvZGluZ3MgPSBbInV0Zi04IiwgInV0Zi04LXNpZyIsICJjcDEyNTIiLCAibGF0aW4tMSJdCiAgICBmb3IgZW5jIGluIGVuY29kaW5nczoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdpdGggb3BlbihwYXRoLCAiciIsIGVuY29kaW5nPWVuYykgYXMgZjoKICAgICAgICAgICAgICAgIHJldHVybiBmLnJlYWRsaW5lcygpCiAgICAgICAgZXhjZXB0IFVuaWNvZGVEZWNvZGVFcnJvcjoKICAgICAgICAgICAgY29udGludWUKICAgIHdpdGggb3BlbihwYXRoLCAiciIsIGVuY29kaW5nPSJ1dGYtOCIsIGVycm9ycz0icmVwbGFjZSIpIGFzIGY6CiAgICAgICAgcmV0dXJuIGYucmVhZGxpbmVzKCkKCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT0KIyBBVVRPIEZJWCBDT0RFIEVSUk9SCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT0KCmRlZiBhdXRvX2ZpeF9lcnJvcihmaWxlX3BhdGgsIGVycm9yX21lc3NhZ2UpOgogICAgcHJpbnQoIltBVVRPIEZJWF0gxJBhbmcgcGjDom4gdMOtY2ggbOG7l2nigKYiKQoKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhmaWxlX3BhdGgpOgogICAgICAgIHByaW50KCJbQVVUTyBGSVhdIEtow7RuZyB0w6xtIHRo4bqleSBmaWxlISIpCiAgICAgICAgcmV0dXJuCgogICAgbGluZXMgPSByZWFkX3RleHRfZmlsZV9yZXNpbGllbnQoZmlsZV9wYXRoKQogICAgZml4ZWQgPSBGYWxzZQoKICAgICMgRml4IEZpbHRlcnMg4oaSIGZpbHRlcnMKICAgIGlmICJjYW5ub3QgaW1wb3J0IG5hbWUgJ0ZpbHRlcnMnIiBpbiBlcnJvcl9tZXNzYWdlOgogICAgICAgIHByaW50KCJbQVVUTyBGSVhdIEZpbHRlcnMg4oaSIGZpbHRlcnMiKQogICAgICAgIGxpbmVzID0gW2xpbmUucmVwbGFjZSgiRmlsdGVycyIsICJmaWx0ZXJzIikgZm9yIGxpbmUgaW4gbGluZXNdCiAgICAgICAgZml4ZWQgPSBUcnVlCgogICAgIyBGaXggUGFyc2VNb2RlCiAgICBpZiAiY2Fubm90IGltcG9ydCBuYW1lICdQYXJzZU1vZGUnIiBpbiBlcnJvcl9tZXNzYWdlOgogICAgICAgIHByaW50KCJbQVVUTyBGSVhdIEZpeCBQYXJzZU1vZGUgdGVsZWdyYW0gdjIwKyIpCiAgICAgICAgZm9yIGksIGxpbmUgaW4gZW51bWVyYXRlKGxpbmVzKToKICAgICAgICAgICAgaWYgImZyb20gdGVsZWdyYW0gaW1wb3J0IFBhcnNlTW9kZSIgaW4gbGluZToKICAgICAgICAgICAgICAgIGxpbmVzW2ldID0gImZyb20gdGVsZWdyYW0uY29uc3RhbnRzIGltcG9ydCBQYXJzZU1vZGVcbiIKICAgICAgICAgICAgICAgIGZpeGVkID0gVHJ1ZQoKICAgICMgRml4IHF1b3RlCiAgICBpZiAibmFtZSAncXVvdGUnIGlzIG5vdCBkZWZpbmVkIiBpbiBlcnJvcl9tZXNzYWdlOgogICAgICAgIHByaW50KCJbQVVUTyBGSVhdIFRow6ptIGltcG9ydCBxdW90ZSIpCiAgICAgICAgbGluZXMuaW5zZXJ0KDAsICJmcm9tIHVybGxpYi5wYXJzZSBpbXBvcnQgcXVvdGVcbiIpCiAgICAgICAgZml4ZWQgPSBUcnVlCgogICAgIyBNaXNzaW5nIG1vZHVsZQogICAgbWlzc2luZyA9IHJlLnNlYXJjaChyIk5vIG1vZHVsZSBuYW1lZCAnKC4rPyknIiwgZXJyb3JfbWVzc2FnZSkKICAgIGlmIG1pc3Npbmc6CiAgICAgICAgbW9kdWxlID0gbWlzc2luZy5ncm91cCgxKQogICAgICAgIHByaW50KGYiW0FVVE8gRklYXSBUaGnhur91IG1vZHVsZSB7bW9kdWxlfSDihpIgYXV0byBpbnN0YWxsIikKICAgICAgICBpbnN0YWxsX2lmX21pc3NpbmcobW9kdWxlKQogICAgICAgIGZpeGVkID0gVHJ1ZQoKICAgIGlmIGZpeGVkOgogICAgICAgIHdpdGggb3BlbihmaWxlX3BhdGgsICJ3IiwgZW5jb2Rpbmc9InV0Zi04IiwgZXJyb3JzPSJyZXBsYWNlIikgYXMgZjoKICAgICAgICAgICAgZi53cml0ZWxpbmVzKGxpbmVzKQogICAgICAgIHByaW50KCJbQVVUTyBGSVhdIMSQw6Mgc+G7rWEgJiBsxrB1IGZpbGUuIikKICAgIGVsc2U6CiAgICAgICAgcHJpbnQoIltBVVRPIEZJWF0gS2jDtG5nIGPDsyBs4buXaSBwaOG7lSBiaeG6v24gxJHhu4Mgc+G7rWEuIikKCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT0KIyBSVU4gRklMRSArIEFVVE8gUkVTVEFSVAojID09PT09PT09PT09PT09PT09PT09PT09PT09CgpkZWYgcnVuX2ZpbGUoZmlsZV9uYW1lKToKICAgIHdoaWxlIFRydWU6CiAgICAgICAgcHJpbnQoZiJbU1RBUlRdIENo4bqheSDihpIge2ZpbGVfbmFtZX0iKQoKICAgICAgICBwcm9jZXNzID0gc3VicHJvY2Vzcy5Qb3BlbigKICAgICAgICAgICAgW3N5cy5leGVjdXRhYmxlLCBmaWxlX25hbWVdLAogICAgICAgICAgICBzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLAogICAgICAgICAgICBzdGRlcnI9c3VicHJvY2Vzcy5QSVBFLAogICAgICAgICAgICB0ZXh0PVRydWUsCiAgICAgICAgICAgIGVuY29kaW5nPSJ1dGYtOCIsCiAgICAgICAgICAgIGVycm9ycz0icmVwbGFjZSIsCiAgICAgICAgICAgIGJ1ZnNpemU9MQogICAgICAgICkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBmb3IgbGluZSBpbiBwcm9jZXNzLnN0ZG91dDoKICAgICAgICAgICAgICAgIHByaW50KGYiW0xPR11be2ZpbGVfbmFtZX1dIHtsaW5lLnJzdHJpcCgpfSIpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBwcmludChmIltTVERPVVQgRVJST1JdIHtlfSIpCgogICAgICAgIHRyeToKICAgICAgICAgICAgc3RkZXJyID0gcHJvY2Vzcy5zdGRlcnIucmVhZCgpCiAgICAgICAgICAgIGlmIHN0ZGVycjoKICAgICAgICAgICAgICAgIHByaW50KGYiW0NSQVNIXVt7ZmlsZV9uYW1lfV1cbntzdGRlcnJ9IikKICAgICAgICAgICAgICAgIGF1dG9fZml4X2Vycm9yKGZpbGVfbmFtZSwgc3RkZXJyKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZiJbU1RERVJSIEVSUk9SXSB7ZX0iKQoKICAgICAgICBwcmludCgiW1JFU1RBUlRdIEto4bufaSDEkeG7mW5nIGzhuqFpIHNhdSA1IGdpw6J54oCmIikKICAgICAgICB0aW1lLnNsZWVwKDUpCgojID09PT09PT09PT09PT09PT09PT09PT09PT09CiMgTU9OSVRPUiBNVUxUSSBQUk9DRVNTCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT0KCmRlZiBtb25pdG9yX3Byb2Nlc3Nlcyhwcm9jZXNzX2RpY3QpOgogICAgd2hpbGUgVHJ1ZToKICAgICAgICBmb3IgZmlsZSwgcHJvYyBpbiBsaXN0KHByb2Nlc3NfZGljdC5pdGVtcygpKToKICAgICAgICAgICAgaWYgcHJvYy5wb2xsKCkgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBwcmludChmIltERVRFQ1RdIHtmaWxlfSBjaOG6v3Qg4oaSIHJlc3RhcnQiKQogICAgICAgICAgICAgICAgbmV3X3Byb2MgPSBzdWJwcm9jZXNzLlBvcGVuKFtzeXMuZXhlY3V0YWJsZSwgX19maWxlX18sICJjaGlsZCIsIGZpbGVdKQogICAgICAgICAgICAgICAgcHJvY2Vzc19kaWN0W2ZpbGVdID0gbmV3X3Byb2MKICAgICAgICB0aW1lLnNsZWVwKDIpCgojID09PT09PT09PT09PT09PT09PT09PT09PT09CiMgUlVOIE1VTFRJUExFIEZJTEVTCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT0KCmRlZiBydW5fbXVsdGlwbGVfZmlsZXMoKToKICAgIGZpbGVfbGlzdCA9IFsiYm90MS5weSIsICJyb29tMS5weSIsICJjaGF0Z3B0MS5weSJdCiAgICBwcm9jZXNzX2RpY3QgPSB7fQoKICAgIGZvciBmaWxlIGluIGZpbGVfbGlzdDoKICAgICAgICBwID0gc3VicHJvY2Vzcy5Qb3Blbihbc3lzLmV4ZWN1dGFibGUsIF9fZmlsZV9fLCAiY2hpbGQiLCBmaWxlXSkKICAgICAgICBwcm9jZXNzX2RpY3RbZmlsZV0gPSBwCgogICAgcHJpbnQoIltTWVNURU1dIMSQw6Mga2jhu59pIGNo4bqheSB04bqldCBj4bqjIGZpbGUuIikKCiAgICB0cnk6CiAgICAgICAgbW9uaXRvcl9wcm9jZXNzZXMocHJvY2Vzc19kaWN0KQogICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgIHByaW50KCJbU1lTVEVNXSBE4burbmcgdG/DoG4gYuG7mSBib3QuIikKICAgICAgICBmb3IgcCBpbiBwcm9jZXNzX2RpY3QudmFsdWVzKCk6CiAgICAgICAgICAgIHAudGVybWluYXRlKCkKICAgICAgICAgICAgCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT0KIyBFTlRSWSBQT0lOVAojID09PT09PT09PT09PT09PT09PT09PT09PT09CgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgaWYgbGVuKHN5cy5hcmd2KSA9PSAzIGFuZCBzeXMuYXJndlsxXSA9PSAiY2hpbGQiOgogICAgICAgIHJ1bl9maWxlKHN5cy5hcmd2WzJdKQogICAgZWxzZToKICAgICAgICBydW5fbXVsdGlwbGVfZmlsZXMoKQo=').decode('utf-8'))
